<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>게시판</title>
</head>
<body>
  <h1>게시판</h1>
  <button id="write-btn" style="display:none;" onclick="location.href='write.html'">글쓰기</button>
  <div id="post-list">게시글을 불러오는 중...</div>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
    const supabase = supabase.createClient('https://lqkglbaqcnwbhvdjhwka.supabase.co', 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imxxa2dsYmFxY253Ymh2ZGpod2thIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDU4MDcxMzgsImV4cCI6MjA2MTM4MzEzOH0.c6Vt3XKENy6pDr2nBhJQz-M9tAQ1RZC3oTfg23ftLfI');

    async function checkLogin() {
      const { data: { session } } = await supabase.auth.getSession();
      const user = session?.user;
      if (user?.email === 'salliground@gmail.com') {
        document.getElementById('write-btn').style.display = 'inline-block';
      }
    }

    async function loadPosts() {
      const { data, error } = await supabase.from('posts').select('*').order('id', { ascending: false });
      const postList = document.getElementById('post-list');
      if (error || !data) {
        postList.innerText = '게시글을 불러오는데 실패했습니다';
        return;
      }
      postList.innerHTML = data.map(post =>
        `<div><a href="read.html?id=${post.id}">${post.title}</a></div>`
      ).join('');
    }

    checkLogin();
    loadPosts();
  </script>
</body>
</html>